<!--pages/event/activity-info.wxml-->
<view class="container page-container">
  <!-- æ´»åŠ¨å¤´éƒ¨ä¿¡æ¯ -->
  <view class="event-hero" wx:if="{{eventInfo}}">
    <view class="hero-background"></view>
    <view class="hero-content">
      <!-- æ´»åŠ¨çŠ¶æ€ -->
      <view class="event-status-bar">
        <view class="status-item approval-{{eventInfo.approval_status}}">
          <text class="status-dot"></text>
          <text class="status-text">{{eventInfo.approval_status_text}}</text>
        </view>
        <view class="status-item status-{{eventInfo.status}}">
          <text class="status-icon">{{eventInfo.status_icon}}</text>
          <text class="status-text">{{eventInfo.status_text}}</text>
        </view>
      </view>

      <!-- æ´»åŠ¨æ ‡é¢˜å’Œä¹¦ç± -->
      <view class="event-title-section">
        <view class="event-title">{{eventInfo.title}}</view>
        <view class="event-book">
          <text class="book-icon">ğŸ“–</text>
          <text class="book-name">{{eventInfo.book_name}}</text>
        </view>
      </view>

      <!-- æ´»åŠ¨æ—¶é—´ä¿¡æ¯ -->
      <view class="event-time-info">
        <view class="time-item">
          <text class="time-icon">ğŸ“…</text>
          <view class="time-content">
            <text class="time-label">æ´»åŠ¨æ—¶é—´</text>
            <text class="time-value">{{eventInfo.date_range}}</text>
          </view>
        </view>
        <view class="time-item">
          <text class="time-icon">â°</text>
          <view class="time-content">
            <text class="time-label">æ´»åŠ¨å¤©æ•°</text>
            <text class="time-value">{{eventInfo.days_count}}å¤©</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- æ´»åŠ¨è¯¦ç»†ä¿¡æ¯å¡ç‰‡ -->
  <view class="info-section" wx:if="{{eventInfo}}">
    <!-- å‚ä¸ç»Ÿè®¡ -->
    <view class="info-card prominent">
      <view class="card-header">
        <text class="card-icon">ğŸ‘¥</text>
        <text class="card-title">å‚ä¸ä¿¡æ¯</text>
      </view>
      <view class="card-content">
        <view class="info-grid">
          <view class="info-item">
            <text class="info-label">å½“å‰äººæ•°</text>
            <text class="info-value">{{eventInfo.participants_count}}äºº</text>
          </view>
          <view class="info-item">
            <text class="info-label">æœ€å¤§äººæ•°</text>
            <text class="info-value">{{eventInfo.max_participants}}äºº</text>
          </view>
          <view class="info-item">
            <text class="info-label">æ´»åŠ¨è´¹ç”¨</text>
            <text class="info-value">{{eventInfo.enrollment_fee || 0}}å…ƒ</text>
          </view>
          <view class="info-item">
            <text class="info-label">å‰©ä½™åé¢</text>
            <text class="info-value">{{eventInfo.remaining_slots || 0}}äºº</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æ´»åŠ¨ä»‹ç» -->
    <view class="info-card">
      <view class="card-header">
        <text class="card-icon">ğŸ“‹</text>
        <text class="card-title">æ´»åŠ¨ä»‹ç»</text>
      </view>
      <view class="card-content">
        <text class="description-text">{{eventInfo.description || 'æš‚æ— è¯¦ç»†ä»‹ç»'}}</text>
      </view>
    </view>

    <!-- æ´»åŠ¨è§„åˆ™ -->
    <view class="info-card">
      <view class="card-header">
        <text class="card-icon">ğŸ“œ</text>
        <text class="card-title">æ´»åŠ¨è§„åˆ™</text>
      </view>
      <view class="card-content">
        <text class="rules-text">{{eventInfo.rules || 'æš‚æ— è§„åˆ™è¯´æ˜'}}</text>
      </view>
    </view>

    <!-- æ´»åŠ¨è®¾ç½® -->
    <view class="info-card">
      <view class="card-header">
        <text class="card-icon">âš™ï¸</text>
        <text class="card-title">æ´»åŠ¨è®¾ç½®</text>
      </view>
      <view class="card-content">
        <view class="settings-list">
          <view class="setting-item">
            <text class="setting-label">æ´»åŠ¨æ¨¡å¼</text>
            <text class="setting-value">{{eventInfo.activity_mode_text || 'ç¬”è®°æ‰“å¡'}}</text>
          </view>
          <view class="setting-item">
            <text class="setting-label">å®Œæˆæ ‡å‡†</text>
            <text class="setting-value">{{eventInfo.completion_standard || 80}}%</text>
          </view>
          <view class="setting-item">
            <text class="setting-label">é¢†è¯»åˆ†é…</text>
            <text class="setting-value">{{eventInfo.leader_assignment_type_text || 'è‡ªæ„¿æŠ¥å'}}</text>
          </view>
          <view class="setting-item">
            <text class="setting-label">æœ€å°å‚ä¸äººæ•°</text>
            <text class="setting-value">{{eventInfo.min_participants || 5}}äºº</text>
          </view>
        </view>
      </view>
    </view>

    <!-- ç»„ç»‡è€…ä¿¡æ¯ -->
    <view class="info-card" wx:if="{{eventInfo.leader}}">
      <view class="card-header">
        <text class="card-icon">ğŸ‘¤</text>
        <text class="card-title">ç»„ç»‡è€…ä¿¡æ¯</text>
      </view>
      <view class="card-content">
        <view class="organizer-info">
          <image class="organizer-avatar" src="{{eventInfo.leader.avatar_url}}" mode="aspectFill"></image>
          <view class="organizer-details">
            <view class="organizer-name">{{eventInfo.leader.nickname}}</view>
            <view class="organizer-bio">{{eventInfo.leader.bio || 'æ´»åŠ¨ç»„ç»‡è€…'}}</view>
            <view class="organizer-stats" wx:if="{{eventInfo.leader.stats}}">
              <text class="stat-text">å·²ç»„ç»‡{{eventInfo.leader.stats.organized_count || 0}}åœºæ´»åŠ¨</text>
            </view>
          </view>
          <button class="contact-btn" bindtap="contactOrganizer">
            <text class="btn-icon">ğŸ’¬</text>
            <text class="btn-text">è”ç³»</text>
          </button>
        </view>
      </view>
    </view>

    <!-- æ´»åŠ¨çŠ¶æ€æ—¶é—´çº¿ -->
    <view class="info-card">
      <view class="card-header">
        <text class="card-icon">ğŸ•</text>
        <text class="card-title">æ´»åŠ¨æ—¶é—´çº¿</text>
      </view>
      <view class="card-content">
        <view class="timeline">
          <view class="timeline-item">
            <view class="timeline-dot {{eventInfo.status === 'enrolling' ? 'active' : ''}}"></view>
            <view class="timeline-content">
              <text class="timeline-title">æŠ¥åé˜¶æ®µ</text>
              <text class="timeline-time">{{eventInfo.enrollment_start_date || 'æ´»åŠ¨å¼€å§‹'}} - {{eventInfo.start_date}}</text>
            </view>
          </view>
          <view class="timeline-item">
            <view class="timeline-dot {{eventInfo.status === 'in_progress' ? 'active' : ''}}"></view>
            <view class="timeline-content">
              <text class="timeline-title">è¿›è¡Œé˜¶æ®µ</text>
              <text class="timeline-time">{{eventInfo.start_date}} - {{eventInfo.end_date}}</text>
            </view>
          </view>
          <view class="timeline-item">
            <view class="timeline-dot {{eventInfo.status === 'completed' ? 'active' : ''}}"></view>
            <view class="timeline-content">
              <text class="timeline-title">å®Œæˆé˜¶æ®µ</text>
              <text class="timeline-time">{{eventInfo.end_date}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œåŒº -->
  <view class="bottom-actions" wx:if="{{eventInfo}}">
    <button class="action-btn outline" bindtap="goBack">
      <text class="btn-icon">â†</text>
      <text class="btn-text">è¿”å›è¯¦æƒ…</text>
    </button>
    <button class="action-btn primary" bindtap="shareEvent">
      <text class="btn-icon">ğŸ“¤</text>
      <text class="btn-text">åˆ†äº«æ´»åŠ¨</text>
    </button>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-overlay" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{!loading && !eventInfo}}">
    <text class="empty-emoji">ğŸ“š</text>
    <text class="empty-text">æ´»åŠ¨ä¿¡æ¯ä¸å­˜åœ¨</text>
    <text class="empty-desc">è¯¥æ´»åŠ¨å¯èƒ½å·²è¢«åˆ é™¤æˆ–æ‚¨æ²¡æœ‰è®¿é—®æƒé™</text>
    <button class="btn btn-primary" bindtap="goBack">è¿”å›</button>
  </view>
</view>