<!--pages/profile/profile.wxml-->
<view class="container page-container">
  <!-- ä¸ªäººä¿¡æ¯å¤´éƒ¨ -->
  <view class="profile-hero" wx:if="{{userInfo}}">
    <view class="hero-background"></view>
    <view class="hero-content">
      <view class="profile-section">
        <!-- ç”¨æˆ·å¤´åƒåŒºåŸŸ -->
        <view class="avatar-section">
          <view class="avatar-wrapper" bindtap="changeAvatar">
            <image class="avatar avatar-xlarge" src="{{userInfo.avatar_url}}" mode="aspectFill"></image>
            <view class="avatar-border"></view>
            <view class="avatar-edit">
              <text class="edit-icon">ğŸ“·</text>
            </view>
          </view>
          <view class="user-level">
            <text class="level-badge">Lv.{{userInfo.level || 1}}</text>
          </view>
        </view>

        <!-- ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ -->
        <view class="user-info">
          <view class="user-name">
            <text class="name-text">{{userInfo.nickname}}</text>
            <view class="verified-badge" wx:if="{{userInfo.verified}}">
              <text class="verified-icon">âœ“</text>
            </view>
          </view>
          <view class="user-bio" wx:if="{{userInfo.bio}}">
            <text class="bio-text">{{userInfo.bio}}</text>
          </view>
          <view class="user-meta">
            <view class="meta-item">
              <text class="meta-icon">ğŸ“…</text>
              <text class="meta-text">{{userInfo.created_at}} åŠ å…¥</text>
            </view>
          </view>
          <view class="profile-actions">
            <button class="action-btn primary" bindtap="editProfile">
              <text class="btn-icon">âœï¸</text>
              <text class="btn-text">ç¼–è¾‘èµ„æ–™</text>
            </button>
          </view>
        </view>
      </view>

      <!-- ä¸ªäººç»Ÿè®¡å¡ç‰‡ -->
      <view class="stats-section">
        <view class="stats-grid">
          <view class="stat-card primary" bindtap="goToMyEvents">
            <view class="stat-icon">ğŸ“š</view>
            <view class="stat-content">
              <view class="stat-number">{{stats.events_count || 0}}</view>
              <view class="stat-label">å‚ä¸æ´»åŠ¨</view>
            </view>
            <view class="stat-trend" wx:if="{{stats.events_trend > 0}}">
              <text class="trend-icon">ğŸ“ˆ</text>
            </view>
          </view>
          <view class="stat-card secondary" bindtap="goToMyPosts">
            <view class="stat-icon">âœï¸</view>
            <view class="stat-content">
              <view class="stat-number">{{stats.posts_count || 0}}</view>
              <view class="stat-label">å‘å¸ƒåŠ¨æ€</view>
            </view>
            <view class="stat-trend" wx:if="{{stats.posts_trend > 0}}">
              <text class="trend-icon">ğŸ“ˆ</text>
            </view>
          </view>
          <view class="stat-card accent" bindtap="goToMyLikes">
            <view class="stat-icon">â¤ï¸</view>
            <view class="stat-content">
              <view class="stat-number">{{stats.likes_count || 0}}</view>
              <view class="stat-label">è·å¾—ç‚¹èµ</view>
            </view>
            <view class="stat-trend" wx:if="{{stats.likes_trend > 0}}">
              <text class="trend-icon">ğŸ“ˆ</text>
            </view>
          </view>
          <view class="stat-card success" bindtap="goToMyFlowers">
            <view class="stat-icon">ğŸŒ¸</view>
            <view class="stat-content">
              <view class="stat-number">{{stats.flowers_count || 0}}</view>
              <view class="stat-label">å°çº¢èŠ±</view>
            </view>
            <view class="stat-trend" wx:if="{{stats.flowers_trend > 0}}">
              <text class="trend-icon">ğŸ“ˆ</text>
            </view>
          </view>
        </view>

        <!-- é˜…è¯»æˆå°±è¿›åº¦ -->
        <view class="achievement-section">
          <view class="achievement-header">
            <text class="achievement-title">é˜…è¯»æˆå°±</text>
            <text class="achievement-desc">ç»§ç»­åŠªåŠ›ï¼Œè§£é”æ›´å¤šæˆå°±ï¼</text>
          </view>
          <view class="achievement-progress">
            <view class="progress-item">
              <view class="progress-info">
                <text class="progress-label">è¿ç»­é˜…è¯»</text>
                <text class="progress-value">7å¤©</text>
              </view>
              <view class="progress-bar">
                <view class="progress-fill" style="width: 70%"></view>
              </view>
            </view>
            <view class="progress-item">
              <view class="progress-info">
                <text class="progress-label">æœ¬æœˆé˜…è¯»</text>
                <text class="progress-value">12å°æ—¶</text>
              </view>
              <view class="progress-bar">
                <view class="progress-fill" style="width: 40%"></view>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- åŠŸèƒ½èœå•åŒºåŸŸ -->
  <view class="features-section" wx:if="{{userInfo}}">
    <!-- æˆ‘çš„å†…å®¹ -->
    <view class="feature-group">
      <view class="group-header">
        <text class="group-title">æˆ‘çš„å†…å®¹</text>
      </view>
      <view class="feature-grid">
        <view class="feature-item" bindtap="goToMyEvents">
          <view class="feature-icon-wrapper primary">
            <text class="feature-icon">ğŸ“š</text>
          </view>
          <view class="feature-content">
            <view class="feature-title">æˆ‘çš„æ´»åŠ¨</view>
            <view class="feature-count">{{stats.events_count || 0}}</view>
          </view>
        </view>
        <view class="feature-item" bindtap="goToMyPosts">
          <view class="feature-icon-wrapper secondary">
            <text class="feature-icon">âœï¸</text>
          </view>
          <view class="feature-content">
            <view class="feature-title">æˆ‘çš„åŠ¨æ€</view>
            <view class="feature-count">{{stats.posts_count || 0}}</view>
          </view>
        </view>
        <view class="feature-item" bindtap="goToMyLikes">
          <view class="feature-icon-wrapper accent">
            <text class="feature-icon">â¤ï¸</text>
          </view>
          <view class="feature-content">
            <view class="feature-title">æˆ‘çš„ç‚¹èµ</view>
            <view class="feature-count">{{stats.likes_count || 0}}</view>
          </view>
        </view>
        <view class="feature-item" bindtap="goToMyFlowers">
          <view class="feature-icon-wrapper success">
            <text class="feature-icon">ğŸŒ¸</text>
          </view>
          <view class="feature-content">
            <view class="feature-title">å°çº¢èŠ±</view>
            <view class="feature-count">{{stats.flowers_count || 0}}</view>
          </view>
        </view>
      </view>
    </view>

    <!-- åº”ç”¨è®¾ç½® -->
    <view class="settings-group">
      <view class="group-header">
        <text class="group-title">åº”ç”¨è®¾ç½®</text>
      </view>
      <view class="settings-list">
        <view class="setting-item" bindtap="goToSettings">
          <view class="setting-left">
            <view class="setting-icon">âš™ï¸</view>
            <view class="setting-content">
              <view class="setting-title">è´¦å·è®¾ç½®</view>
              <view class="setting-desc">ä¸ªäººä¿¡æ¯ã€éšç§è®¾ç½®</view>
            </view>
          </view>
          <view class="setting-right">
            <text class="setting-arrow">â€º</text>
          </view>
        </view>
        <view class="setting-item" bindtap="goToNotifications">
          <view class="setting-left">
            <view class="setting-icon">ğŸ””</view>
            <view class="setting-content">
              <view class="setting-title">é€šçŸ¥è®¾ç½®</view>
              <view class="setting-desc">æ¶ˆæ¯æ¨é€ã€æé†’è®¾ç½®</view>
            </view>
          </view>
          <view class="setting-right">
            <view class="notification-badge" wx:if="{{unreadCount > 0}}">{{unreadCount}}</view>
            <text class="setting-arrow">â€º</text>
          </view>
        </view>
        <view class="setting-item" bindtap="goToNoteExport">
          <view class="setting-left">
            <view class="setting-icon">ğŸ“‹</view>
            <view class="setting-content">
              <view class="setting-title">ç¬”è®°å¯¼å‡º</view>
              <view class="setting-desc">å¯¼å‡ºå…±è¯»æ´»åŠ¨ä½œä¸šå†…å®¹</view>
            </view>
          </view>
          <view class="setting-right">
            <text class="setting-arrow">â€º</text>
          </view>
        </view>
        <view class="setting-item" bindtap="goToPrivacy">
          <view class="setting-left">
            <view class="setting-icon">ğŸ”’</view>
            <view class="setting-content">
              <view class="setting-title">éšç§è®¾ç½®</view>
              <view class="setting-desc">æ•°æ®ä½¿ç”¨ã€éšç§ä¿æŠ¤</view>
            </view>
          </view>
          <view class="setting-right">
            <text class="setting-arrow">â€º</text>
          </view>
        </view>
      </view>
    </view>

    <!-- å¸®åŠ©ä¸æ”¯æŒ -->
    <view class="support-group">
      <view class="group-header">
        <text class="group-title">å¸®åŠ©ä¸æ”¯æŒ</text>
      </view>
      <view class="support-list">
        <view class="support-item" bindtap="goToHelp">
          <view class="support-left">
            <view class="support-icon">â“</view>
            <view class="support-content">
              <view class="support-title">å¸®åŠ©ä¸­å¿ƒ</view>
              <view class="support-desc">ä½¿ç”¨æŒ‡å—ã€å¸¸è§é—®é¢˜</view>
            </view>
          </view>
          <view class="support-right">
            <text class="support-arrow">â€º</text>
          </view>
        </view>
        <view class="support-item" bindtap="goToFeedback">
          <view class="support-left">
            <view class="support-icon">ğŸ’¬</view>
            <view class="support-content">
              <view class="support-title">æ„è§åé¦ˆ</view>
              <view class="support-desc">é—®é¢˜æŠ¥å‘Šã€åŠŸèƒ½å»ºè®®</view>
            </view>
          </view>
          <view class="support-right">
            <text class="support-arrow">â€º</text>
          </view>
        </view>
        <view class="support-item" bindtap="goToAbout">
          <view class="support-left">
            <view class="support-icon">â„¹ï¸</view>
            <view class="support-content">
              <view class="support-title">å…³äºæˆ‘ä»¬</view>
              <view class="support-desc">ç‰ˆæœ¬ä¿¡æ¯ã€è”ç³»æ–¹å¼</view>
            </view>
          </view>
          <view class="support-right">
            <text class="support-arrow">â€º</text>
          </view>
        </view>
      </view>
    </view>

    <!-- é€€å‡ºç™»å½• -->
    <view class="logout-section">
      <button class="logout-btn" bindtap="logout">
        <text class="logout-icon">ğŸšª</text>
        <text class="logout-text">é€€å‡ºç™»å½•</text>
      </button>
    </view>
  </view>

  <!-- æœªç™»å½•çŠ¶æ€ -->
  <view class="login-section" wx:if="{{!userInfo}}">
    <view class="login-card">
      <view class="login-illustration">
        <text class="login-emoji">ğŸ‘¤</text>
      </view>
      <view class="login-title">æ¬¢è¿æ¥åˆ°æ°æ°è¯»ä¹¦ä¼š</view>
      <view class="login-subtitle">ç™»å½•åæŸ¥çœ‹ä¸ªäººä¿¡æ¯ï¼Œäº«å—å®Œæ•´åŠŸèƒ½</view>
      <button class="btn btn-primary btn-login" bindtap="goToLogin">
        <text class="btn-text">ç«‹å³ç™»å½•</text>
        <text class="btn-arrow">â†’</text>
      </button>
    </view>
  </view>

  <!-- ç‰ˆæœ¬ä¿¡æ¯ -->
  <view class="version-section">
    <view class="version-info">
      <text class="version-text">æ°æ°è¯»ä¹¦ä¼š v2.0.0</text>
      <text class="version-desc">è®©é˜…è¯»æˆä¸ºä¹ æƒ¯</text>
    </view>
  </view>

  <!-- è‡ªå®šä¹‰TabBar -->
  <custom-tabbar current="{{3}}"></custom-tabbar>
</view>